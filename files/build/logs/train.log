
------------------------------------
Keras version      : 2.2.4-tf
TensorFlow version : 1.15.2
Python version     : 3.6.15 | packaged by conda-forge | (default, Dec  3 2021, 18:49:41) 
[GCC 9.4.0]
------------------------------------
Command line options:
 --input_height    :  28
 --input_width     :  28
 --input_chan      :  1
 --epochs          :  10
 --batchsize       :  100
 --learnrate       :  0.0001
 --output_ckpt_path:  ./build/chkpts/float_model.ckpt
 --infer_graph_path:  ./build/chkpts/inference_graph.pb
 --tboard_path     :  ./build/tb_logs
 --gpu             :  0
------------------------------------

Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
    8192/11490434 [..............................] - ETA: 1s   65536/11490434 [..............................] - ETA: 9s  212992/11490434 [..............................] - ETA: 5s  352256/11490434 [..............................] - ETA: 5s  565248/11490434 [>.............................] - ETA: 4s  753664/11490434 [>.............................] - ETA: 4s 1146880/11490434 [=>............................] - ETA: 3s 1359872/11490434 [==>...........................] - ETA: 3s 1540096/11490434 [===>..........................] - ETA: 3s 1736704/11490434 [===>..........................] - ETA: 3s 1835008/11490434 [===>..........................] - ETA: 3s 2310144/11490434 [=====>........................] - ETA: 2s 2490368/11490434 [=====>........................] - ETA: 2s 2670592/11490434 [=====>........................] - ETA: 2s 2736128/11490434 [======>.......................] - ETA: 2s 3211264/11490434 [=======>......................] - ETA: 2s 3407872/11490434 [=======>......................] - ETA: 2s 3588096/11490434 [========>.....................] - ETA: 2s 3768320/11490434 [========>.....................] - ETA: 2s 3997696/11490434 [=========>....................] - ETA: 2s 4456448/11490434 [==========>...................] - ETA: 2s 4636672/11490434 [===========>..................] - ETA: 2s 4816896/11490434 [===========>..................] - ETA: 1s 4997120/11490434 [============>.................] - ETA: 1s 5455872/11490434 [=============>................] - ETA: 1s 5685248/11490434 [=============>................] - ETA: 1s 5832704/11490434 [==============>...............] - ETA: 1s 5980160/11490434 [==============>...............] - ETA: 1s 6012928/11490434 [==============>...............] - ETA: 1s 6291456/11490434 [===============>..............] - ETA: 1s 6553600/11490434 [================>.............] - ETA: 1s 6717440/11490434 [================>.............] - ETA: 1s 6750208/11490434 [================>.............] - ETA: 1s 6979584/11490434 [=================>............] - ETA: 1s 7323648/11490434 [==================>...........] - ETA: 1s 7340032/11490434 [==================>...........] - ETA: 1s 7553024/11490434 [==================>...........] - ETA: 1s 7946240/11490434 [===================>..........] - ETA: 1s 8110080/11490434 [====================>.........] - ETA: 1s 8126464/11490434 [====================>.........] - ETA: 1s 8306688/11490434 [====================>.........] - ETA: 1s 8650752/11490434 [=====================>........] - ETA: 0s 8749056/11490434 [=====================>........] - ETA: 0s 9093120/11490434 [======================>.......] - ETA: 0s 9240576/11490434 [=======================>......] - ETA: 0s 9404416/11490434 [=======================>......] - ETA: 0s 9568256/11490434 [=======================>......] - ETA: 0s 9748480/11490434 [========================>.....] - ETA: 0s 9912320/11490434 [========================>.....] - ETA: 0s10076160/11490434 [=========================>....] - ETA: 0s10158080/11490434 [=========================>....] - ETA: 0s10436608/11490434 [==========================>...] - ETA: 0s10584064/11490434 [==========================>...] - ETA: 0s10764288/11490434 [===========================>..] - ETA: 0s10928128/11490434 [===========================>..] - ETA: 0s11059200/11490434 [===========================>..] - ETA: 0s11239424/11490434 [============================>.] - ETA: 0s11386880/11490434 [============================>.] - ETA: 0s11493376/11490434 [==============================] - 4s 0us/step
Network input shape:  (?, 28, 28, 1)
WARNING:tensorflow:From /workspace/customcnn.py:42: conv2d (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.keras.layers.Conv2D` instead.
WARNING:tensorflow:From /opt/vitis_ai/conda/envs/vitis-ai-tensorflow/lib/python3.6/site-packages/tensorflow_core/python/layers/convolutional.py:424: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From /workspace/customcnn.py:43: batch_normalization (from tensorflow.python.layers.normalization) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.BatchNormalization instead.  In particular, `tf.control_dependencies(tf.GraphKeys.UPDATE_OPS)` should not be used (consult the `tf.keras.layers.batch_normalization` documentation).
                      (?, 14, 14, 16)
                      (?, 7, 7, 32)
                      (?, 4, 4, 64)
                      (?, 1, 1, 10)
WARNING:tensorflow:From /workspace/customcnn.py:63: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
Network output shape: (?, 10)
WARNING:tensorflow:From /opt/vitis_ai/conda/envs/vitis-ai-tensorflow/lib/python3.6/site-packages/tensorflow_core/python/ops/losses/losses_impl.py:121: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where

----------------------------
 TRAINING STARTED...
----------------------------
 Epoch 1 / 10 - accuracy 90.98 %
 Epoch 2 / 10 - accuracy 94.22 %
 Epoch 3 / 10 - accuracy 95.78 %
 Epoch 4 / 10 - accuracy 96.54 %
 Epoch 5 / 10 - accuracy 96.96 %
 Epoch 6 / 10 - accuracy 97.02 %
 Epoch 7 / 10 - accuracy 97.32 %
 Epoch 8 / 10 - accuracy 97.60 %
 Epoch 9 / 10 - accuracy 97.78 %
 Epoch 10 / 10 - accuracy 98.02 %

----------------------------
 SAVING CHECKPOINT & GRAPH...
----------------------------
 Saved checkpoint to ./build/chkpts/float_model.ckpt
Network input shape:  (?, 28, 28, 1)
                      (?, 14, 14, 16)
                      (?, 7, 7, 32)
                      (?, 4, 4, 64)
                      (?, 1, 1, 10)
Network output shape: (?, 10)
 Saved binary inference graph to ./build/chkpts/inference_graph.pb
 Run `tensorboard --logdir=./build/tb_logs --port 6006 --host localhost` to see the results.
